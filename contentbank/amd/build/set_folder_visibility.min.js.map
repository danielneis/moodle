{"version":3,"file":"set_folder_visibility.min.js","sources":["../src/set_folder_visibility.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Module to manage content bank folder actions, such as create, delete or rename.\n *\n * @module     core_contentbank/set_folder_visibility\n * @copyright  2023 Daniel Neis Araujo\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine([\n    'jquery',\n    'core/ajax',\n    'core/notification',\n    'core/str',\n    'core/url',\n],\nfunction($, Ajax, Notification, Str, Url) {\n\n    /**\n     * SetFolderVisibility class.\n     */\n    var SetFolderVisibility = function() {\n        this.registerEvents();\n    };\n\n    /**\n     * Register event listeners.\n     */\n    SetFolderVisibility.prototype.registerEvents = function() {\n        $('[data-action=\"setfoldervisibility\"]').click(function(e) {\n            e.preventDefault();\n\n            var folderid = $(this).data('folderid');\n            var contextid = $(this).data('contextid');\n            var visibility = $(this).data('visibility');\n\n            setFolderVisibility(folderid, contextid, visibility);\n        });\n    };\n\n    /**\n     * Set folder visibility in the content bank.\n     *\n     * @param {int} folderid The folder to modify\n     * @param {int} contextid The context the folder belongs to\n     * @param {int} visibility The new visibility value\n     */\n    function setFolderVisibility(folderid, contextid, visibility) {\n        var request = {\n            methodname: 'core_contentbank_set_folder_visibility',\n            args: {\n                folderid: folderid,\n                contextid: contextid,\n                visibility: visibility\n            }\n        };\n        var requestType = 'success';\n        Ajax.call([request])[0].then(function(data) {\n            if (data.result) {\n                return 'foldervisibilitychanged';\n            }\n            requestType = 'error';\n            return data.warnings[0].message;\n\n        }).then(function(message) {\n            var params = null;\n            if (requestType == 'success') {\n                params = {\n                    folderid: folderid,\n                    contextid: contextid,\n                    statusmsg: message\n                };\n                // Redirect to the folder view page and display the message as a notification.\n                window.location.href = Url.relativeUrl('contentbank/index.php', params, false);\n            } else {\n                // Fetch error notifications.\n                Notification.addNotification({\n                    message: message,\n                    type: 'error'\n                });\n                Notification.fetchNotifications();\n            }\n            return;\n        }).catch(Notification.exception);\n    }\n\n    return /** @alias module:core_contentbank/set_folder_visibility */ {\n        // Public variables and functions.\n\n        /**\n         * Initialise the contentbank set folder visibility.\n         *\n         * @method init\n         * @return {SetFolderVisibility}\n         */\n        'init': function() {\n            return new SetFolderVisibility();\n        }\n    };\n});\n"],"names":["define","$","Ajax","Notification","Str","Url","SetFolderVisibility","registerEvents","prototype","click","e","preventDefault","folderid","contextid","visibility","request","methodname","args","requestType","call","then","data","result","warnings","message","params","statusmsg","window","location","href","relativeUrl","addNotification","type","fetchNotifications","catch","exception","setFolderVisibility","this"],"mappings":";;;;;;;AAsBAA,gDAAO,CACH,SACA,YACA,oBACA,WACA,aAEJ,SAASC,EAAGC,KAAMC,aAAcC,IAAKC,SAK7BC,oBAAsB,gBACjBC,yBAMTD,oBAAoBE,UAAUD,eAAiB,WAC3CN,EAAE,uCAAuCQ,OAAM,SAASC,GACpDA,EAAEC,0BAiBmBC,SAAUC,UAAWC,gBAC1CC,QAAU,CACVC,WAAY,yCACZC,KAAM,CACFL,SAAUA,SACVC,UAAWA,UACXC,WAAYA,aAGhBI,YAAc,UAClBhB,KAAKiB,KAAK,CAACJ,UAAU,GAAGK,MAAK,SAASC,aAC9BA,KAAKC,OACE,2BAEXJ,YAAc,QACPG,KAAKE,SAAS,GAAGC,YAEzBJ,MAAK,SAASI,aACTC,OAAS,KACM,WAAfP,aACAO,OAAS,CACLb,SAAUA,SACVC,UAAWA,UACXa,UAAWF,SAGfG,OAAOC,SAASC,KAAOxB,IAAIyB,YAAY,wBAAyBL,QAAQ,KAGxEtB,aAAa4B,gBAAgB,CACzBP,QAASA,QACTQ,KAAM,UAEV7B,aAAa8B,yBAGlBC,MAAM/B,aAAagC,WA/ClBC,CAJenC,EAAEoC,MAAMhB,KAAK,YACZpB,EAAEoC,MAAMhB,KAAK,aACZpB,EAAEoC,MAAMhB,KAAK,mBAoD6B,MASvD,kBACG,IAAIf"}